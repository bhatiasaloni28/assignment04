---
title: "index.Rmd"
output: html_document
date: "2023-10-04"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
library(haven)
library(ggplot2)
library(tidyverse)
library(ggrepel)
library(dplyr)
```

[Data Sources](https://microdata.worldbank.org/index.php/catalog/3769/get-microdata)

## Overarching Narrative: 

## Nationwide lockdown and school closures were common during the covid-19 pandemic. The Learning Loss Covid-19 database (2021) has been used to analyse the impact of school closures on learning outcomes across 41 countries that have been bifurcated into six regions including East Asia and the Pacific, Europe and Central Asia, Latin America and the Caribbean, South Asia, Sub-Saharan Africa and other Advanced Economies. The graph on deaths vs vaccination rate per region provides the larger picture of the the six regions during the pandemic, corroberated with the bar graph showing the average decline in test scores per region. One could assume that countries with stringent lockdowns would have shut schools for a longer duration. The scatter plot on decline in test scores due to school closures per country shows a positive relationship between the duration (in weeks) of school closures and declining test scores (in standard deviation). Since the pandemic led to the shift from learning in classrooms to remote/virual learning, the pie chart has been used to understand if regions with higher internet penetration expererienced a lower decline in learning outcomes.

## Decline in Test Scores (measured in standard deviation) due to School Closure (measured in number of weeks)

## The graph below shows decline in test scores due to the number of weeks that schools remained closed in 41 countries. The upward sloping trend line depicts a positive relationship between declinee in test scores (measured in standard deviation) and weeks of school closure. The points of the scatter plot represent countries with varying levels of test score decline  and weeks of school closure. 

``` {r}

data <- read_dta('data/learning_loss_covid_database.dta')

ggplot(data, aes(x = weeks, y = loss, color = "Country")) + 
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
   theme_minimal(base_family = "Times New Roman") +
  xlab("Average number of weeks of school closure in 2021") + 
  ylab("Decline in test scores") +
  ggtitle("Decline in test scores due to the duration of school closure") +
  theme(plot.title = element_text(hjust = 0.5),
         legend.position = "top",
         legend.title = element_blank(),
         plot.background = element_rect(fill = "grey"),  
         panel.background = element_rect(fill = "white"))
  
```


## Decline in Test Scores By Region During 2021 - Measured in Standard Deviation

#### The below graph breaks down the decline in test scores during covid-19 by region. According to the data below, South Asia witnessed the highest steepest average decline of over 50%, with Latin America in second place at over 30% and Sub-Saharan Africa averaging around 35%. While these regions did experience the worst declines in grades during CV-19, it's possible some of these figures are skewed as each region is not wholly representative. For example, South Asia only includes Bangladesh, India, and Nepal. 

```{r}

suppressWarnings({ 

custom_colors <- c("olivedrab3", "orange", "steelblue", "pink", "coral", "violet")

region_mean <- data %>%
  group_by(region_code) %>%
  summarize(mean_loss = mean(loss))

region_mean %>%
  ggplot() +
  geom_col(mapping = aes(x = region_code, y = mean_loss, fill = region_code)) +
  scale_fill_manual(values = custom_colors) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(
    title = "Average Decline in Test Scores By Region 2021",
    subtitle = "Due to COVID school closures",
    x = "Region",
    y = "Percent Decline in Test Scores"
  ) + 
  guides(fill = FALSE) 

}) 
```


## Death Versus Vaccination Rates By Region in 2021

#### The graph below depicts death and vaccination rates by regions, highlighting specific countries. While some Advanced Economies exhibited higher vaccination rates and death rates, such as the United States, it's important to note that factors like strict lockdown measures, travel constraints, and variations in data reporting can influence these outcomes. For example, China's stringent lockdowns and high vaccination rates contributed to lower death rates, whereas the US experienced high vaccination rates with varying levels of lockdown enforcement. Additionally, insufficient death reporting in some poorer countries due to administrative challenges is another significant variable to consider.

```{r second, echo=FALSE}

countries_to_label <- data %>%
  filter(country %in% c("Nepal", "Hungary", "Argentina", "India", "Korea", "United States", "Kenya", "China", "Germany"))

data %>%
  ggplot() +
  geom_point(mapping = aes(x = deaths, y = vac, color = region_code)) +
  geom_text(data = countries_to_label, mapping = aes(x = deaths, y = vac, label = country)) + 
  labs(
    title = "Death Rate Average Compared to Vaccination Rate in 2021",
    subtitle = "Data: https://ourworldindata.org/grapher/covid-vaccination-doses-per-capita",
    x = "Average Death Rate",
    y = "Vaccination Rate - Doses per Capita"
  ) 
  
```

## Internet Penetration by region 

## The pie chart shows the %share of internet penetration by region. Since the study focuses on learning loss during covid-19, the graph could is useful to compare if countries with higher internet penetration had a lower learning loss. 

```{r, echo=FALSE}

internet_mean <- data %>%
  group_by(region_code) %>%
  summarize(mean_internet = mean(internet))

internet_mean %>%
  ggplot(mapping = aes(x = "", y = mean_internet, fill = region_code)) +
  geom_bar(stat = "identity", width = 1) +
  geom_text(aes(label = paste0(round(mean_internet, 1), "%")),
            position = position_stack(vjust = 0.5)) +
  coord_polar(theta = "y") +
  theme_void(base_family = "Times New Roman") +
  ggtitle("Internet penetration by region") +
  theme(plot.title = element_text(hjust = 0.5),
         legend.position = "right",
         legend.title = element_blank(),
         plot.background = element_rect(fill = "grey"),  
         panel.background = element_rect(fill = "white")) 
         

```

