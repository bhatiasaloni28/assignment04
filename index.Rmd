---
title: "index.Rmd"
output: html_document
date: "2023-10-04"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
library(haven)
library(ggplot2)
library(tidyverse)
library(ggrepel)
library(dplyr)
```

[Data Sources] (https://microdata.worldbank.org/index.php/catalog/3769/get-microdata)

## (ADD TITLE HERE! Take out parantheses)

``` {r}

data <- read_dta('data/learning_loss_covid_database.dta')

# Scatter Plot + Line 
ggplot(data, aes(x = weeks, y = loss, color = "Line")) + 
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed")
  theme_minimal() +
  xlab("Weeks Closed on Average in 2021") + 
  ylab("Decline in Test Scores (measured in standard deviation units)") +
  ggtitle("Decline in Test Scores due to School Closure") 
```

```{r}
# Line Graph 
  ggplot(data, aes(x = weeks, y = loss, color = "Line")) +
  geom_line(size = 1) +
  geom_point(size = 1, shape = 16) +
  theme_minimal() +
  theme(
    panel.background = element_rect(fill = "lightgray"),
    panel.grid.major = element_line(color = "white", size = 0.5),
    legend.position = "top"  # Adjust legend position
  ) +
  xlab("weeks") +
  ylab("Learning Loss") +
  ggtitle("Line Graph") +
  labs(color = "Legend Title") 

```

```{r}
# Another Version 
  ggplot() +
    geom_point(data, mapping = aes(x = weeks, y = loss)) +
    geom_smooth(data, mapping = aes(x = weeks, y = loss))
```


## Decline in Test Scores By Region During 2021 - Measured in Standard Deviation

### The below graph breaks down the decline in test scores during covid-19 by region. According to the data below, South Asia witnessed the highest steepest average decline of over 50%, with Latin America in second place at over 30% and Sub-Saharan Africa averaging around 35%. While these regions did experience the worst declines in grades during CV-19, it's possible some of these figures are skewed as each region is not wholly representative. For example, South Asia only includes Bangladesh, India, and Nepal. 

```{r}

suppressWarnings({ 

custom_colors <- c("olivedrab3", "orange", "steelblue", "pink", "coral", "violet")

region_mean <- data %>%
  group_by(region_code) %>%
  summarize(mean_loss = mean(loss))

region_mean %>%
  ggplot() +
  geom_col(mapping = aes(x = region_code, y = mean_loss, fill = region_code)) +
  scale_fill_manual(values = custom_colors) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(
    title = "Average Decline in Test Scores By Region 2021",
    subtitle = "Due to COVID school closures",
    x = "Region",
    y = "Percent Decline in Test Scores"
  ) + 
  guides(fill = FALSE)

}) 
```


## Death Versus Vaccination Rates By Region in 2021

```{r second, echo=FALSE}

countries_to_label <- data %>%
  filter(country %in% c("Nepal", "Hungary", "Argentina", "India", "Korea", "United States", "Kenya", "China", "Germany"))

data %>%
  ggplot() +
  geom_point(mapping = aes(x = deaths, y = vac, color = region_code)) +
  geom_text(data = countries_to_label, mapping = aes(x = deaths, y = vac, label = country)) + 
  labs(
    title = "Death Rate Average Compared to Vaccination Rate in 2021",
    subtitle = "Data: https://ourworldindata.org/grapher/covid-vaccination-doses-per-capita",
    x = "Average Death Rate",
    y = "Vaccination Rate - Doses per Capita"
  ) 
  
```


```{r, echo=FALSE}

data %>%
  ggplot(mapping = aes(x = "", y = internet, fill = region_code)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar(theta = "y") +
  theme_void()

```

