---
title: "index.Rmd"
output: html_document
date: "2023-10-04"
---

```{r setup, include=FALSE}
library(haven)
library(ggplot2)
library(tidyverse)
library(ggrepel)

```



``` {r}

data <- read_dta('data/learning_loss_covid_database.dta')

# Scatter Plot + Line 
ggplot(data, aes(x = weeks, y = loss)) + 
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
  theme_minimal(base_family = "Times New Roman") +
  xlab("Average number of weeks of school closure in 2021") + 
  ylab("Decline in test scores") +
  ggtitle("Decline in test scores due to the duration of school closure") +
 theme(plot.title = element_text(hjust = 0.5),
        legend.position = "top",
        legend.title = element_blank(),
        plot.background = element_rect(fill = "grey"),  
        panel.background = element_rect(fill = "white")) 

```

```{r}

custom_colors <- c("olivedrab3", "orange", "steelblue", "pink", "coral", "violet")

data %>%
  ggplot() +
  geom_col(mapping = aes(x = region_code, y = loss, fill = region_code)) +
  scale_fill_manual(values = custom_colors) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(
    title = "Decline in Test Scores Due to COVID school closures 2021",
    subtitle = "Measured in Standard Deviations",
    x = "Region",
    y = "Decline in Test Scores"
  ) + 
  guides(fill = FALSE)

```


```{r second, echo=FALSE}

####customcolors.....

# Countries to label (replace with your selection)


countries_to_label <- data %>%
  filter(country %in% c("Nepal", "Hungary", "Argentina", "India", "Korea", "United States", "Kenya"))

data %>%
  ggplot() +
  geom_point(mapping = aes(x = deaths, y = loss, color = region_code)) +
  geom_text(filter(data, country %in% countries_to_label),
            mapping = aes(x = deaths, y = loss, label = countries_to_label))


data %>%
  ggplot()+
  geom_point(mapping = aes(x = deaths, y = loss, color = region_code)) +
  geom_text(mapping = aes(x = deaths, y = loss, label = country))

data %>%
  ggplot() +
  geom_col(mapping = aes(x = deaths, y = vaccine, fill = region_code)) +
  

  country abbreviation col
vaccine and death
  
```


```{r}
data %>%
  ggplot(mapping = aes(x = "", y = internet, fill = region_code)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar(theta = "y") +
  theme_void(base_family = "Times New Roman") +
  ggtitle("Internet penetration by region") +
 theme(plot.title = element_text(hjust = 0.5),
        legend.position = "right",
        legend.title = element_blank(),
        plot.background = element_rect(fill = "grey"),  
        panel.background = element_rect(fill = "white")) 
#trying to add % share on the pie chart 
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
